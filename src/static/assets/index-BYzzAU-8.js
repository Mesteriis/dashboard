const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/IndicatorTabPanel-Kxp2dxqr.js","assets/vendor-DIhYXxpQ.js","assets/vendor-icons-BwIvosaC.js","assets/LanPageView-BsRIh4m7.js","assets/LanHostModal-C5AJTrZc.js","assets/BaseModal-CUtSK17p.js","assets/IframeModal-DR4tYXRU.js","assets/ItemEditorModal-C_ONZIS0.js","assets/CommandPaletteModal-DhBEF8l-.js"])))=>i.map(i=>d[i]);
import{o as f,c as b,r as $n,n as N,h as sn,w as $e,a as Xt,b as At,d as lt,e as H,f as T,g as ge,u as i,i as F,j as be,k as g,F as Z,t as D,l as K,m as fe,p as P,q as oe,s as q,v as Ai,x as Zt,T as Di,y as Cn,z as er,A as Ve,B as Mi,C as Oi,D as Gi}from"./vendor-DIhYXxpQ.js";import{s as an,a as ln,b as Ri,c as Bi,d as un,e as Ni,f as tr,g as Vi,h as cn,i as dn,j as fn,k as nt,l as Hi,m as pn,n as Fi,o as Ki,p as gn,q as Ui,r as ji,t as rr,H as st,N as Et,S as Ae,F as Tn,C as En,u as Ln,T as sr,v as Pn,w as xn,D as ar,x as zi,y as Wi,W as qi,A as Ji,E as Yi,z as Qi,M as mn,P as Xi,B as An,G as cr,L as dr,I as Zi,K as es,J as ts,O as vn,Q as Dn,R as bn,U as lr,V as rs,X as ns,Y as os,Z as is,_ as nr,$ as Mn,a0 as ss,a1 as On,a2 as as,a3 as ls,a4 as Gn,a5 as us,a6 as cs,a7 as ds,a8 as fs,a9 as ps,aa as fr,ab as pr,ac as gs,ad as ms,ae as vs,af as bs,ag as Rn,ah as Bn}from"./vendor-icons-BwIvosaC.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))u(a);new MutationObserver(a=>{for(const p of a)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&u(m)}).observe(document,{childList:!0,subtree:!0});function d(a){const p={};return a.integrity&&(p.integrity=a.integrity),a.referrerPolicy&&(p.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?p.credentials="include":a.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function u(a){if(a.ep)return;a.ep=!0;const p=d(a);fetch(a.href,p)}})();const ys="modulepreload",hs=function(n){return"/static/"+n},yn={},He=function(l,d,u){let a=Promise.resolve();if(d&&d.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),y=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));a=Promise.allSettled(d.map(w=>{if(w=hs(w),w in yn)return;yn[w]=!0;const k=w.endsWith(".css"),C=k?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${w}"]${C}`))return;const v=document.createElement("link");if(v.rel=k?"stylesheet":ys,k||(v.as="script"),v.crossOrigin="",v.href=w,y&&v.setAttribute("nonce",y),document.head.appendChild(v),k)return new Promise((E,O)=>{v.addEventListener("load",E),v.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${w}`)))})}))}function p(m){const y=new Event("vite:preloadError",{cancelable:!0});if(y.payload=m,window.dispatchEvent(y),!y.defaultPrevented)throw m}return a.then(m=>{for(const y of m||[])y.status==="rejected"&&p(y.reason);return l().catch(p)})},Is=["type","title","aria-label","disabled"],ve={__name:"IconButton",props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},type:{type:String,default:"button"},title:{type:String,default:""},ariaLabel:{type:String,default:""},buttonClass:{type:String,default:""}},emits:["click"],setup(n){return(l,d)=>(f(),b("button",{class:N(["ghost icon-btn",[n.buttonClass,{active:n.active}]]),type:n.type,title:n.title,"aria-label":n.ariaLabel||n.title,disabled:n.disabled,onClick:d[0]||(d[0]=u=>l.$emit("click",u))},[$n(l.$slots,"default")],10,Is))}},ws="X-Dashboard-Token";function Ss(){var d;if(typeof window>"u")return"";const n=((d=window.localStorage)==null?void 0:d.getItem("dashboard_admin_token"))||"";if(String(n).trim())return String(n).trim();const l=window.__DASHBOARD_ADMIN_TOKEN__||"";return String(l).trim()}function _s(n,l,d){const u=l&&typeof n=="object"&&n!==null?n.detail:null;let a=`Request failed: ${d}`;return Array.isArray(u)?a=u.map(p=>typeof p=="object"&&p!==null&&"message"in p?String(p.message||""):JSON.stringify(p)).join("; "):typeof u=="string"&&u?a=u:typeof n=="string"&&n&&(a=n),a}async function Ce(n,l={}){const{requireAdminToken:d=!1,headers:u={},...a}=l,p={};if(u instanceof Headers)u.forEach((v,E)=>{p[E]=v});else if(Array.isArray(u))for(const[v,E]of u)p[v]=String(E);else Object.assign(p,u);const m={Accept:"application/json",...p};if(d){const v=Ss();v&&(m[ws]=v)}const y=await fetch(n,{credentials:"same-origin",headers:m,...a}),k=(y.headers.get("content-type")||"").includes("application/json"),C=k?await y.json():await y.text();if(!y.ok){const E=new Error(_s(C,k,y.status));throw E.status=y.status,E.body=C,E}return C}const Ke="/api/v1/dashboard";function ks(){return Ce(`${Ke}/config`)}function $s(n){return Ce(`${Ke}/iframe/${encodeURIComponent(n)}/source`,{requireAdminToken:!0})}function Cs(n=[]){const l=new URLSearchParams;for(const u of n)l.append("item_id",u);const d=l.toString();return Ce(`${Ke}/health${d?`?${d}`:""}`)}function Ts(n){return Ce(`${Ke}/config`,{requireAdminToken:!0,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}function Es(){return Ce(`${Ke}/lan/state`)}function Ls(){return Ce(`${Ke}/lan/run`,{requireAdminToken:!0,method:"POST"})}const or="oko-particles-js",Ps="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js",xs=7e3;let ot=null;function ur(){return typeof window.particlesJS=="function"}function As(n){return new Promise(l=>{let d=!1;const u=p=>{d||(d=!0,l(p))},a=window.setTimeout(()=>{u(ur())},xs);n.addEventListener("load",()=>{window.clearTimeout(a),u(ur())},{once:!0}),n.addEventListener("error",()=>{window.clearTimeout(a),u(!1)},{once:!0})})}async function Ds(){return typeof window>"u"||typeof document>"u"?!1:ur()?!0:ot||(ot=(async()=>{let n=document.getElementById(or)instanceof HTMLScriptElement?document.getElementById(or):null;n||(n=document.createElement("script"),n.id=or,n.src=Ps,n.async=!0,n.defer=!0,document.head.appendChild(n));const l=await As(n);return l||(ot=null),l})(),ot)}function x(n){const l=`#${n.hex}`;return(d,{attrs:u})=>sn("svg",{...u,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",role:"img","aria-hidden":"true",style:u.style?[u.style,{color:l}]:{color:l}},[sn("path",{d:n.path})])}const Lt={homeassistant:x(rr),"home-assistant":x(rr),ha:x(rr),openwrt:x(ji),adguard:x(Ui),proxmox:x(gn),pve:x(gn),grafana:x(Ki),gitea:x(Fi),jellyfin:x(pn),jellyseerr:x(pn),sonarr:x(nt),radarr:x(Hi),lidarr:x(nt),readarr:x(nt),bazarr:x(nt),prowlarr:x(nt),qbittorrent:x(fn),qb:x(fn),postgres:x(dn),postgresql:x(dn),docker:x(cn),dockge:x(cn),cockpit:x(Vi),npm:x(tr),nginxproxymanager:x(tr),"nginx-proxy-manager":x(tr),nginx:x(Ni),openai:x(un),ai:x(un),portainer:x(Bi),ytsync:x(ln),youtube:x(Ri),youtubeshorts:x(ln),termius:x(an),termix:x(an)},Pt={home:st,house:st,дом:st,dom:st,route:as,net:Et,network:Et,сеть:Et,dashboard:On,infra:Ae,infrastructure:Ae,инфраструктура:Ae,server:Ae,core:ss,ops:Mn,media:nr,медиа:nr,tv:nr,iot:En,cloud:is,wifi:os,monitor:ns,cockpit:rs,proxmox:Ae,grafana:Ln,gitea:lr,git:lr,jellyfin:Tn,navidrome:mn,tunnel:bn,tunnels:bn,stats:Dn,services:vn,service:vn,health:Pn,alerts:sr,alert:sr,security:xn,auth:ts,key:es,db:ar,database:ar,storage:Zi,link:dr,iframe:cr,terminal:An,package:Xi,music:mn,camera:Qi,eye:Yi,observability:Ji,workflow:qi,settings:Wi,spark:zi},Nn=[{re:/\b(home|house|dom|дом)\b/,icon:st},{re:/\b(net|network|route|vpn|edge|сеть|маршрут|туннел)\b/,icon:Et},{re:/\b(infra|server|cluster|pve|проксмокс|инфраструктур)\b/,icon:Ae},{re:/\b(media|tv|video|stream|jellyfin|медиа)\b/,icon:Tn},{re:/\b(iot|sensor|home-assistant|умн|дом)\b/,icon:En},{re:/\b(stat|metric|chart|grafana|аналит|monitor)\b/,icon:Ln},{re:/\b(alert|error|warn|critical|ошиб|авар)\b/,icon:sr},{re:/\b(health|status|pulse|heart|состояни)\b/,icon:Pn},{re:/\b(auth|token|secret|lock|ключ|безопас)\b/,icon:xn},{re:/\b(db|database|postgres|mysql|redis)\b/,icon:ar}],Fe={page:On,group:Gn,subgroup:ls,itemLink:dr,itemIframe:cr,widget:Dn};function Vn(n){return String(n||"").toLowerCase().replace(/[^a-z0-9а-яё._-]+/gi," ").split(/[\s._-]+/).filter(Boolean)}function Hn(n){if(Lt[n])return Lt[n];for(const[l,d]of Object.entries(Lt))if(n.includes(l))return d;if(Pt[n])return Pt[n];for(const[l,d]of Object.entries(Pt))if(n.includes(l))return d;return null}function Ue(n,l){for(const u of n)for(const a of Vn(u)){const p=Hn(a);if(p)return p}const d=n.map(u=>String(u||"").toLowerCase()).filter(Boolean).join(" ");for(const u of Nn)if(u.re.test(d))return u.icon;return l}function Ms(n){return Ue([n==null?void 0:n.icon,n==null?void 0:n.title,n==null?void 0:n.id],Fe.page)}function Os(n){return Ue([n==null?void 0:n.icon,n==null?void 0:n.title,n==null?void 0:n.id,n==null?void 0:n.description],Fe.group)}function Gs(n){return Ue([n==null?void 0:n.icon,n==null?void 0:n.title,n==null?void 0:n.id],Fe.subgroup)}function Rs(n){return Ue([n==null?void 0:n.icon,n==null?void 0:n.title,n==null?void 0:n.id,n==null?void 0:n.type,n==null?void 0:n.url,...(n==null?void 0:n.tags)||[]],(n==null?void 0:n.type)==="iframe"?Fe.itemIframe:Fe.itemLink)}function Bs(n){var l;return Ue([n==null?void 0:n.icon,n==null?void 0:n.title,n==null?void 0:n.id,n==null?void 0:n.type,(l=n==null?void 0:n.data)==null?void 0:l.endpoint],Fe.widget)}function at(n,l="node"){return String(n||"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"")||l}function xe(n,l){const d=at(n,"node");let u=d,a=2;for(;l.has(u);)u=`${d}-${a}`,a+=1;return u}function xt(n){const l=new Set;for(const d of n.groups||[])for(const u of d.subgroups||[])l.add(u.id);return l}function Ct(n){const l=new Set;for(const d of n.groups||[])for(const u of d.subgroups||[])for(const a of u.items||[])l.add(a.id);return l}function me(n,l){return(n.groups||[]).find(d=>d.id===l)||null}function de(n,l,d){const u=me(n,l);return u&&(u.subgroups||[]).find(a=>a.id===d)||null}function Tt(n){return String((n==null?void 0:n.key)||"").startsWith("group:")}function hn(n){var a,p;const l=new Set((n.groups||[]).map(m=>m.id)),d=xt(n),u=new Set([...l,...d]);for(const m of((a=n.layout)==null?void 0:a.pages)||[]){const y=[];for(const w of m.blocks||[]){if(w.type==="groups"){w.group_ids=(w.group_ids||[]).filter(k=>u.has(k)),w.group_ids.length&&y.push(w);continue}(w.widgets||[]).length&&y.push(w)}!y.length&&((p=n.groups)!=null&&p.length)&&y.push({type:"groups",group_ids:[n.groups[0].id]}),m.blocks=y}}function In(n,l,d){var m;const u=((m=n.layout)==null?void 0:m.pages)||[];if(!u.length)return;const a=u.find(y=>y.id===l)||u[0];let p=a.blocks.find(y=>y.type==="groups");if(!p){p={type:"groups",group_ids:[d]},a.blocks.push(p);return}p.group_ids.includes(d)||p.group_ids.push(d)}function wn(n,l,d){const u=n.groups||[],a=u.findIndex(w=>w.id===l),p=u.findIndex(w=>w.id===d);if(a<0||p<0||a===p)return!1;const[m]=u.splice(a,1),y=a<p?p-1:p;return u.splice(y,0,m),!0}function Sn(n,l,d,u,a){const p=me(n,l),m=me(n,u);if(!p||!m)return!1;const y=(p.subgroups||[]).findIndex(C=>C.id===d),w=(m.subgroups||[]).findIndex(C=>C.id===a);if(y<0||w<0)return!1;if(l!==u&&p.subgroups.length<=1)throw new Error("В исходной группе должна остаться минимум одна подгруппа.");const[k]=p.subgroups.splice(y,1);if(l===u){const C=y<w?w-1:w;return p.subgroups.splice(C,0,k),!0}return m.subgroups.splice(w,0,k),!0}function _n(n,l,d,u,a,p,m){const y=de(n,l,d),w=de(n,a,p);if(!y||!w)return!1;const k=(y.items||[]).findIndex(E=>E.id===u),C=(w.items||[]).findIndex(E=>E.id===m);if(k<0||C<0)return!1;if(d!==p&&y.items.length<=1)throw new Error("В исходной подгруппе должен остаться минимум один элемент.");const[v]=y.items.splice(k,1);if(d===p){const E=k<C?C-1:C;return y.items.splice(E,0,v),!0}return w.items.splice(C,0,v),!0}function kn(n,l,d,u,a,p){const m=de(n,l,d),y=de(n,a,p);if(!m||!y)return!1;const w=(m.items||[]).findIndex(C=>C.id===u);if(w<0)return!1;if(d!==p&&m.items.length<=1)throw new Error("В исходной подгруппе должен остаться минимум один элемент.");const[k]=m.items.splice(w,1);return y.items.push(k),!0}function Ns(n){const l=String(n||"").trim();if(!l)throw new Error("URL не может быть пустым");const d=/^https?:\/\//i.test(l)?l:`https://${l}`;let u;try{u=new URL(d)}catch{throw new Error(`Некорректный URL: ${l}`)}if(!["http:","https:"].includes(u.protocol))throw new Error(`Разрешены только http/https URL: ${l}`);return u.toString()}function Vs(n){const l=String(n||"").trim();if(!l)return"";const d=/^https?:\/\//i.test(l)?l:`https://${l}`;try{const u=new URL(d);return["http:","https:"].includes(u.protocol)?u.origin:""}catch{return""}}let it=null;function le(){if(it)return it;const n="/static/img/emblem-mark.png",l=3e4,d=700,u=1e4,a="lan",p=new Set(["stat_list","table"]),m="https://example.com",y="sidebar-particles",w="hero-title-particles",k="hero-controls-particles",C={particles:{number:{value:88,density:{enable:!0,value_area:700}},color:{value:"#6df6e2"},shape:{type:"circle"},opacity:{value:.36,random:!0},size:{value:2.4,random:!0},line_linked:{enable:!0,distance:120,color:"#2dd4bf",opacity:.24,width:1.2},move:{enable:!0,speed:1.2}},interactivity:{events:{onhover:{enable:!1},onclick:{enable:!1},resize:!0}},retina_detect:!0},v={particles:{number:{value:92,density:{enable:!0,value_area:720}},color:{value:"#6df6e2"},shape:{type:"circle"},opacity:{value:.4,random:!0},size:{value:2.4,random:!0},line_linked:{enable:!0,distance:132,color:"#2dd4bf",opacity:.26,width:1.2},move:{enable:!0,speed:1.2}},interactivity:{events:{onhover:{enable:!1},onclick:{enable:!1},resize:!0}},retina_detect:!0},E=Object.freeze([{value:"detailed",label:"Карточки"},{value:"tile",label:"Плитка"},{value:"icon",label:"Значки"}]),O=Object.freeze([{value:"groups",label:"Только группы"},{value:"tags_in_groups",label:"Группы + теги"},{value:"tags",label:"Только теги"},{value:"flat",label:"Без групп (плитка)"}]),J=["detailed","sections","hidden"],ie=18,G=10;function U(){return{id:"",title:"",type:"link",url:m,icon:"",siteInput:"",tagsInput:"",open:"new_tab",healthcheckEnabled:!1,healthcheckUrl:"",healthcheckIntervalSec:30,healthcheckTimeoutMs:1500,iframeSandboxMode:"default",iframeAllowInput:"",iframeReferrerPolicy:"",authProfile:""}}const h=H(null),M=H(!0),A=H(""),V=H(""),te=H(""),De=H(!1),re=H(""),B=H(!1),z=H("detailed"),he=H("groups"),ue=H("all"),pe=H("detailed"),Y=H("idle"),Q=H(""),se=H(null),je=H(!1),Me=H(!1),Te=H(""),Ee=H(!1),R=H(""),ee=H(0),W=ge({open:!1,host:null}),Ie=ge({}),ut=ge({}),ct=new Map;let ze=0,Le=0,We=0,dt=!1;const S=ge({groupKey:"",subgroupId:"",itemId:""}),ce=ge({}),qe=ge({}),L=ge({type:"",groupId:"",subgroupId:"",itemId:""}),Je=ge({}),X=ge({open:!1,title:"",src:"",allow:"",sandbox:!1,referrerPolicy:"",loading:!1,error:""}),$=ge({open:!1,mode:"create",groupId:"",subgroupId:"",originalItemId:"",submitting:!1,error:"",form:U()}),we=T(()=>{var t,r;if(!h.value)return[];const e=((r=(t=h.value)==null?void 0:t.layout)==null?void 0:r.pages)||[];return e.some(o=>o.id===a)?e:[...e,{id:a,title:"LAN",icon:"network",blocks:[]}]}),Dt=T(()=>{var e;return((e=h.value)==null?void 0:e.widgets)||[]}),gr=T(()=>{var e,t;return((t=(e=h.value)==null?void 0:e.security)==null?void 0:t.auth_profiles)||[]}),Fn=T(()=>{var e,t;return((t=(e=h.value)==null?void 0:e.app)==null?void 0:t.title)||"Oko"}),Kn=T(()=>{var e,t;return((t=(e=h.value)==null?void 0:e.app)==null?void 0:t.tagline)||"Your Infrastructure in Sight"}),Un=T(()=>E),jn=T(()=>O),mr=T(()=>z.value==="icon"),vr=T(()=>z.value==="tile"),br=T(()=>mr.value||vr.value),Mt=T(()=>pe.value==="detailed"),yr=T(()=>pe.value==="sections"),ft=T(()=>pe.value==="hidden"),zn=T(()=>!1),Wn=T(()=>Mt.value?"Режим меню: полное. Нажмите, чтобы оставить только разделы":yr.value?"Режим меню: только разделы. Нажмите, чтобы скрыть меню":"Режим меню: скрыто. Нажмите, чтобы вернуть полное меню"),hr=T(()=>{var e,t;return((t=(e=se.value)==null?void 0:e.result)==null?void 0:t.hosts)||[]}),qn=T(()=>{var t,r;const e=((r=(t=se.value)==null?void 0:t.result)==null?void 0:r.scanned_cidrs)||[];return e.length?e.join(", "):"нет данных"}),Jn=T(()=>Y.value==="saving"?"Сохранение...":Y.value==="saved"?"Сохранено":Y.value==="error"?"Ошибка сохранения":B.value?"Готово":"Сохранение выключено"),pt=T(()=>{var r;const e=new Map;for(const o of((r=h.value)==null?void 0:r.groups)||[])for(const s of o.subgroups||[])for(const c of s.items||[]){const I=et(c,o);if(!I)continue;const _=I.toLowerCase();e.has(_)||e.set(_,I)}const t=Array.from(e.entries()).sort((o,s)=>o[1].localeCompare(s[1],"ru",{sensitivity:"base"}));return[{value:"all",label:"Все sites"},...t.map(([o,s])=>({value:o,label:s}))]}),gt=T(()=>{const e=new Map;for(const t of Dt.value)e.set(t.id,t);return e}),Ot=T(()=>{var t;const e=new Map;for(const r of((t=h.value)==null?void 0:t.groups)||[])e.set(r.id,r);return e}),Ir=T(()=>{var t;const e=new Map;for(const r of((t=h.value)==null?void 0:t.groups)||[])for(const o of r.subgroups||[])e.set(o.id,{group:r,subgroup:o});return e}),Yn=T(()=>{const e=new Map;for(const t of we.value)for(const r of t.blocks||[])if((r==null?void 0:r.type)==="groups")for(const o of r.group_ids||[])e.has(o)||e.set(o,t.id);return e}),wr=T(()=>{const e=new Map;for(const t of hr.value||[]){const r=String((t==null?void 0:t.ip)||"").trim();if(r)for(const o of(t==null?void 0:t.dashboard_items)||[]){const s=String((o==null?void 0:o.id)||"").trim();s&&!e.has(s)&&e.set(s,r)}}return e}),Qn=T(()=>{var r;const e=[],t=Yn.value;for(const o of((r=h.value)==null?void 0:r.groups)||[])for(const s of o.subgroups||[])for(const c of s.items||[]){const I=xo(c==null?void 0:c.url),_=wr.value.get(c.id)||"",j=(c.tags||[]).map(ye=>String(ye||"").trim()).filter(Boolean),ne=et(c,o);if(ue.value!=="all"&&ne.toLowerCase()!==ue.value)continue;const Pe=t.get(o.id)||t.get(s.id)||"",ke=String(c.title||"").trim(),Ne=[ke,String(c.id||""),String(c.url||""),I,_,ne,String(o.title||""),String(s.title||""),...j].join(" ").toLowerCase();e.push({id:c.id,item:c,title:ke,titleLower:ke.toLowerCase(),host:I.toLowerCase(),ip:_.toLowerCase(),site:ne.toLowerCase(),tagsLower:j.map(ye=>ye.toLowerCase()),groupId:o.id,groupKey:`group:${o.id}`,groupTitle:String(o.title||""),subgroupId:s.id,subgroupTitle:String(s.title||""),pageId:Pe,searchBlob:Ne})}return e}),Ye=T(()=>{const e=String(R.value||"").trim().toLowerCase(),t=Qn.value;if(!e)return t.slice().sort((s,c)=>s.title.localeCompare(c.title,"ru",{sensitivity:"base"})).slice(0,G);const r=e.split(/\s+/).filter(Boolean),o=[];for(const s of t){let c=0,I=!0;for(const _ of r){if(!s.searchBlob.includes(_)){I=!1;break}s.titleLower.startsWith(_)?c+=12:s.titleLower.includes(_)&&(c+=8),s.host.startsWith(_)?c+=7:s.host.includes(_)&&(c+=4),s.ip===_?c+=14:s.ip.includes(_)&&(c+=6),s.site&&s.site.includes(_)&&(c+=5),s.tagsLower.some(j=>j.includes(_))&&(c+=3)}I&&o.push({entry:s,score:c})}return o.sort((s,c)=>c.score!==s.score?c.score-s.score:s.entry.title.localeCompare(c.entry.title,"ru",{sensitivity:"base"})),o.slice(0,ie).map(s=>s.entry)}),Sr=T(()=>Ye.value[ee.value]||null),Se=T(()=>we.value.find(e=>e.id===V.value)||we.value[0]||null),_r=T(()=>{var e;return((e=Se.value)==null?void 0:e.id)===a}),Oe=T(()=>{if(!Se.value)return[];const e=[];for(const t of Se.value.blocks||[])(t==null?void 0:t.type)==="groups"&&e.push(...t.group_ids||[]);return Ht(e)}),kr=T(()=>{const e=Br(Oe.value),t=te.value.trim().toLowerCase();return t?e.map(r=>{if(String(r.title||"").toLowerCase().includes(t)||String(r.description||"").toLowerCase().includes(t))return{...r,subgroups:r.subgroups||[]};const s=(r.subgroups||[]).map(c=>{if(String(c.title||"").toLowerCase().includes(t))return{...c,items:c.items||[]};const _=(c.items||[]).filter(j=>{const ne=String(j.title||"").toLowerCase().includes(t),Pe=String(j.url||"").toLowerCase().includes(t),ke=(j.tags||[]).some(ye=>String(ye).toLowerCase().includes(t)),Ne=et(j,r).toLowerCase().includes(t);return ne||Pe||ke||Ne});return _.length?{...c,items:_}:null}).filter(Boolean);return s.length?{...r,subgroups:s}:null}).filter(Boolean):e}),Xn=T(()=>{const e=[];for(const t of kr.value){e.push({key:`group:${t.key}`,type:"group",groupKey:t.key,group:t});for(const r of t.subgroups||[])e.push({key:`subgroup:${t.key}:${r.id}`,type:"subgroup",groupKey:t.key,subgroupId:r.id,subgroup:r})}return e}),Gt=T(()=>{const e=[];for(const t of Oe.value)for(const r of t.subgroups||[])for(const o of r.items||[])e.push(o.id);return e}),Zn=T(()=>{var r;const e=Gt.value;let t=0;for(const o of e)(r=tt(o))!=null&&r.ok&&(t+=1);return{online:t,total:e.length}}),mt=T(()=>{if(!Se.value)return[];const e=[];for(const t of Se.value.blocks||[])Mr(t)&&e.push(...t.widgets||[]);return Array.from(new Set(e))}),vt=T(()=>Or(mt.value)),eo=T(()=>{const e=vt.value.length;if(!e)return"нет данных";const t=vt.value.filter(r=>Qe(r)).length;return`${e} · больших ${t}`}),to=T(()=>{var e;return(((e=Se.value)==null?void 0:e.blocks)||[]).filter(t=>(t==null?void 0:t.type)==="groups")}),$r=T(()=>{const e=gt.value.get(re.value);return!e||!Qe(e)?null:mt.value.includes(e.id)?e:null});function Cr(e){if(!e)return;const t=document.documentElement;e.accent&&(t.style.setProperty("--accent",e.accent),t.style.setProperty("--accent-soft",e.accent)),e.background&&t.style.setProperty("--bg",e.background),e.border&&t.style.setProperty("--border",e.border),e.card&&(t.style.setProperty("--surface",e.card),t.style.setProperty("--surface-strong",e.card)),t.style.setProperty("--glow-enabled",e.glow===!1?"0":"1")}function Tr(e){if(!e)return;const t=document.documentElement;e.gap!=null&&t.style.setProperty("--grid-gap",`${Number(e.gap)}px`),e.card_radius!=null&&t.style.setProperty("--card-radius",`${Number(e.card_radius)}px`),e.columns!=null&&t.style.setProperty("--layout-columns",String(Number(e.columns)))}function ro(){B.value=!B.value,Q.value="",B.value||Ge()}function no(){if(z.value==="detailed"){z.value="tile";return}if(z.value==="tile"){z.value="icon";return}z.value="detailed"}function oo(){const e=J.indexOf(pe.value),r=((e>=0?e:0)+1)%J.length;pe.value=J[r],Mt.value||(te.value="",Ze()),ft.value&&(he.value="flat")}function io(e){return e?e.type==="group"?Kr(e.groupKey):e.type==="subgroup"?Ur(e.groupKey,e.subgroupId):!1:!1}function so(e){var t,r;return e?e.type==="group"?`Группа: ${((t=e.group)==null?void 0:t.title)||""}`:e.type==="subgroup"?`Подгруппа: ${((r=e.subgroup)==null?void 0:r.title)||""}`:"":""}function ao(e){if(e){if(e.type==="group"){ce[e.groupKey]=!0,S.groupKey=e.groupKey,S.subgroupId="",S.itemId="";return}e.type==="subgroup"&&Hr(e.groupKey,e.subgroupId)}}function lo(e,t,r){if(!br.value)return;const o=(r==null?void 0:r.__originGroupKey)||e,s=(r==null?void 0:r.__originSubgroupId)||t;Kt(o,s,r.id),qt(r)}function Er(e){return JSON.parse(JSON.stringify(e))}function Rt(e){return Ns(e)}async function Lr(){var e;if(h.value){Y.value="saving",Q.value="";try{const t=await Ts(h.value);h.value=t.config,(!V.value||!we.value.some(r=>r.id===V.value))&&(V.value=((e=we.value[0])==null?void 0:e.id)||""),Y.value="saved",Le&&clearTimeout(Le),Le=window.setTimeout(()=>{Y.value==="saved"&&(Y.value="idle")},1400)}catch(t){throw Y.value="error",Q.value=(t==null?void 0:t.message)||"Ошибка сохранения YAML",t}}}async function ae(e){if(!h.value)return!1;const t=Er(h.value);try{return e(h.value)===!1?!1:(hn(h.value),Xe(),await Lr(),!0)}catch(r){return h.value=t,Y.value="error",Q.value=(r==null?void 0:r.message)||"Не удалось применить изменения",!1}}function Bt(e,t){return{id:e,type:"link",title:t,url:m,icon:null,site:null,tags:[],open:"new_tab"}}async function uo(){if(!B.value||!h.value)return;const e=window.prompt("Название новой группы","Новая группа");if(e==null)return;const t=e.trim();t&&await ae(r=>{const o=new Set((r.groups||[]).map(ne=>ne.id)),s=xt(r),c=Ct(r),I=xe(t,o),_=xe(`${I}-core`,s),j=xe(`${I}-service`,c);r.groups.push({id:I,title:t,icon:"folder",description:"",layout:"auto",subgroups:[{id:_,title:"Core",items:[Bt(j,"Новый сервис")]}]}),In(r,V.value,I),ce[`group:${I}`]=!0,S.groupKey=`group:${I}`,S.subgroupId=_,S.itemId=j})}async function co(e){if(!B.value||!h.value)return;const t=window.prompt("Название подгруппы","Новая подгруппа");if(t==null)return;const r=t.trim();r&&await ae(o=>{const s=me(o,e);if(!s)throw new Error(`Группа '${e}' не найдена`);const c=xt(o),I=Ct(o),_=xe(`${e}-${r}`,c),j=xe(`${_}-service`,I);s.subgroups.push({id:_,title:r,items:[Bt(j,"Новый сервис")]}),ce[`group:${e}`]=!0,S.groupKey=`group:${e}`,S.subgroupId=_,S.itemId=j})}async function fo(e,t){!B.value||!h.value||xr(e,t)}function Nt(e){return String(e||"").split(",").map(t=>t.trim()).filter(Boolean)}function Vt(e,t,r,o){const s=Number(e);if(!Number.isFinite(s))return t;const c=Math.trunc(s);return Math.min(o,Math.max(r,c))}function Pr(e=!1){$.submitting&&!e||($.open=!1,$.mode="create",$.groupId="",$.subgroupId="",$.originalItemId="",$.error="",$.submitting=!1,$.form=U())}function xr(e,t){if(!de(h.value,e,t)){Y.value="error",Q.value=`Подгруппа '${t}' не найдена`;return}$.open=!0,$.mode="create",$.groupId=e,$.subgroupId=t,$.originalItemId="",$.error="",$.submitting=!1,$.form=U()}function Ar(e,t,r){var c,I,_;const o=de(h.value,e,t),s=((o==null?void 0:o.items)||[]).find(j=>j.id===r);if(!o||!s){Y.value="error",Q.value=`Элемент '${r}' не найден`;return}$.open=!0,$.mode="edit",$.groupId=e,$.subgroupId=t,$.originalItemId=r,$.error="",$.submitting=!1,$.form={id:s.id,title:s.title,type:s.type,url:String(s.url||m),icon:s.icon||"",siteInput:String(s.site||""),tagsInput:(s.tags||[]).join(", "),open:s.open||"new_tab",healthcheckEnabled:!!(s.type==="link"&&s.healthcheck),healthcheckUrl:s.type==="link"&&s.healthcheck?String(s.healthcheck.url):String(s.url||m),healthcheckIntervalSec:s.type==="link"&&s.healthcheck?Number(s.healthcheck.interval_sec||30):30,healthcheckTimeoutMs:s.type==="link"&&s.healthcheck?Number(s.healthcheck.timeout_ms||1500):1500,iframeSandboxMode:s.type==="iframe"?((c=s.iframe)==null?void 0:c.sandbox)==null?"default":s.iframe.sandbox?"enabled":"disabled":"default",iframeAllowInput:s.type==="iframe"?(((I=s.iframe)==null?void 0:I.allow)||[]).join(", "):"",iframeReferrerPolicy:s.type==="iframe"&&((_=s.iframe)==null?void 0:_.referrer_policy)||"",authProfile:s.type==="iframe"&&s.auth_profile||""}}function Dr(e){const t=$.form,r=String(t.title||"").trim();if(!r)throw new Error("Название сервиса обязательно");const o=String(t.type||"").trim().toLowerCase();if(!["link","iframe"].includes(o))throw new Error("Тип сервиса должен быть 'link' или 'iframe'");const s=String(t.open||"new_tab");if(!["new_tab","same_tab"].includes(s))throw new Error("Параметр open должен быть 'new_tab' или 'same_tab'");const c=Rt(t.url||m),I=Ct(e);$.mode==="edit"&&I.delete($.originalItemId);const _=String(t.id||"").trim(),j=`${$.subgroupId}-${r}`,ne=at(_||j,"service"),Pe=_?ne:xe(ne,I);if(_&&I.has(Pe))throw new Error(`ID '${Pe}' уже существует`);const ke={id:Pe,type:o,title:r,url:c,icon:String(t.icon||"").trim()||null,site:String(t.siteInput||"").trim()||null,tags:Nt(t.tagsInput),open:s};if(o==="link"){const $t={...ke};if(t.healthcheckEnabled){const xi=Rt(t.healthcheckUrl||c);$t.healthcheck={type:"http",url:xi,interval_sec:Vt(t.healthcheckIntervalSec,30,1,3600),timeout_ms:Vt(t.healthcheckTimeoutMs,1500,100,12e4)}}return $t}const Ne=String(t.iframeSandboxMode||"default");let ye=null;Ne==="enabled"&&(ye=!0),Ne==="disabled"&&(ye=!1);const rt=String(t.authProfile||"").trim();if(rt&&!gr.value.some($t=>$t.id===rt))throw new Error(`Auth profile '${rt}' не найден`);const on={...ke,iframe:{sandbox:ye,allow:Nt(t.iframeAllowInput),referrer_policy:String(t.iframeReferrerPolicy||"").trim()||null}};return rt&&(on.auth_profile=rt),on}async function po(){if(!$.open||$.submitting||!h.value)return;$.submitting=!0,$.error="";const e=await ae(t=>{const r=de(t,$.groupId,$.subgroupId);if(!r)throw new Error(`Подгруппа '${$.subgroupId}' не найдена`);const o=Dr(t);if($.mode==="create")return r.items.push(o),S.groupKey=`group:${$.groupId}`,S.subgroupId=$.subgroupId,S.itemId=o.id,!0;const s=(r.items||[]).findIndex(c=>c.id===$.originalItemId);if(s<0)throw new Error(`Элемент '${$.originalItemId}' не найден`);return r.items.splice(s,1,o),S.groupKey=`group:${$.groupId}`,S.subgroupId=$.subgroupId,(S.itemId===$.originalItemId||!S.itemId)&&(S.itemId=o.id),!0});$.submitting=!1,e?Pr(!0):$.error=Q.value||"Не удалось сохранить сервис"}async function go(e){if(!B.value||!h.value)return;const t=me(h.value,e);if(!t)return;const r=window.prompt("Название группы",t.title);if(r==null)return;const o=window.prompt("Описание группы",t.description||"");if(o==null)return;const s=window.prompt("Режим группы (auto | full | inline)",t.layout||"auto");s!=null&&await ae(c=>{const I=me(c,e);if(!I)throw new Error(`Группа '${e}' не найдена`);const _=String(s||"").trim().toLowerCase()||"auto";if(!["auto","full","inline"].includes(_))throw new Error("Режим группы должен быть 'auto', 'full' или 'inline'");I.title=r.trim()||I.title,I.description=o.trim(),I.layout=_})}async function mo(e,t){if(!B.value||!h.value)return;const r=de(h.value,e,t);if(!r)return;const o=window.prompt("Название подгруппы",r.title);o!=null&&await ae(s=>{const c=de(s,e,t);if(!c)throw new Error(`Подгруппа '${t}' не найдена`);c.title=o.trim()||c.title})}async function vo(e,t,r){!B.value||!h.value||Ar(e,t,r)}async function bo(e){if(!B.value||!h.value)return;const t=me(h.value,e);if(t){if(h.value.groups.length<=1){Y.value="error",Q.value="Нельзя удалить последнюю группу.";return}window.confirm(`Удалить группу "${t.title}"?`)&&await ae(r=>{const o=(r.groups||[]).findIndex(s=>s.id===e);if(o<0)return!1;r.groups.splice(o,1),S.groupKey="",S.subgroupId="",S.itemId=""})}}async function yo(e,t){if(!B.value||!h.value)return;const r=me(h.value,e),o=((r==null?void 0:r.subgroups)||[]).find(s=>s.id===t);if(!(!r||!o)){if(r.subgroups.length<=1){Y.value="error",Q.value="В группе должна остаться хотя бы одна подгруппа.";return}window.confirm(`Удалить подгруппу "${o.title}"?`)&&await ae(s=>{const c=me(s,e);if(!c)return!1;const I=(c.subgroups||[]).findIndex(_=>_.id===t);if(I<0)return!1;c.subgroups.splice(I,1),S.subgroupId="",S.itemId=""})}}async function ho(e,t,r){if(!B.value||!h.value)return;const o=de(h.value,e,t),s=((o==null?void 0:o.items)||[]).find(c=>c.id===r);if(!(!o||!s)){if(o.items.length<=1){Y.value="error",Q.value="В подгруппе должен остаться хотя бы один элемент.";return}window.confirm(`Удалить сервис "${s.title}"?`)&&await ae(c=>{const I=de(c,e,t);if(!I)return!1;const _=(I.items||[]).findIndex(j=>j.id===r);if(_<0)return!1;I.items.splice(_,1),S.itemId===r&&(S.itemId="")})}}function Ge(){L.type="",L.groupId="",L.subgroupId="",L.itemId=""}function Io(e,t){if(!B.value||!Tt(t))return;const r=t.id;L.type="group",L.groupId=r,L.subgroupId="",L.itemId="",e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",`group:${r}`))}function wo(e,t,r){B.value&&(L.type="subgroup",L.groupId=t,L.subgroupId=r,L.itemId="",e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",`subgroup:${r}`)))}function So(e,t,r,o){B.value&&(L.type="item",L.groupId=t,L.subgroupId=r,L.itemId=o,e.dataTransfer&&(e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",`item:${o}`)))}function _o(e,t){if(!B.value||!Tt(t))return;const r=t.id;L.type==="group"&&L.groupId!==r&&e.preventDefault()}async function ko(e,t){if(!B.value||!Tt(t))return;const r=t.id;if(L.type!=="group"||!L.groupId||L.groupId===r)return;e.preventDefault();const o=L.groupId;Ge(),await ae(s=>wn(s,o,r))}function $o(e,t,r){if(B.value){if(L.type==="subgroup"){if(L.subgroupId===r)return;e.preventDefault();return}L.type==="item"&&e.preventDefault()}}async function Co(e,t,r){if(B.value){if(L.type==="subgroup"){e.preventDefault();const o=L.groupId,s=L.subgroupId;Ge(),await ae(c=>Sn(c,o,s,t,r));return}if(L.type==="item"){e.preventDefault();const o=L.groupId,s=L.subgroupId,c=L.itemId;Ge(),await ae(I=>kn(I,o,s,c,t,r))}}}function To(e,t,r,o){B.value&&L.type==="item"&&L.itemId!==o&&e.preventDefault()}async function Eo(e,t,r,o){if(!B.value||L.type!=="item"||!L.itemId||L.itemId===o)return;e.preventDefault();const s=L.groupId,c=L.subgroupId,I=L.itemId;Ge(),await ae(_=>_n(_,s,c,I,t,r,o))}function Mr(e){return(e==null?void 0:e.type)==="widget_row"||(e==null?void 0:e.type)==="widget_grid"}function Or(e=[]){return e.map(t=>gt.value.get(t)).filter(Boolean)}function Qe(e){return p.has(String((e==null?void 0:e.type)||""))}function Lo(e){return qr(e).slice(0,2)}function Gr(e){const t=vt.value.find(r=>r.id===e);!t||!Qe(t)||(re.value=t.id)}function Po(e){Qe(e)&&Gr(e.id)}function Ht(e=[]){const t=[];for(const r of e){const o=Ot.value.get(r);if(o){t.push({key:`group:${o.id}`,id:o.id,title:o.title,icon:o.icon||null,description:o.description||"",layout:o.layout||"auto",subgroups:o.subgroups||[]});continue}const s=Ir.value.get(r);s&&t.push({key:`subgroup:${s.subgroup.id}`,id:s.group.id,title:s.group.title,icon:s.group.icon||null,description:s.group.description||"",layout:s.group.layout||"auto",subgroups:[s.subgroup]})}return t}function Xe(){const e=new Set(Oe.value.map(t=>t.key));for(const t of Object.keys(ce))e.has(t)||delete ce[t];for(const t of Oe.value)ce[t.key]==null&&(ce[t.key]=!0);S.groupKey&&!e.has(S.groupKey)&&Ze()}function Ze(){S.groupKey="",S.subgroupId="",S.itemId=""}function xo(e){try{return new URL(String(e||"")).hostname||""}catch{return""}}function Ao(e,t,r){const o=String((e==null?void 0:e.site)||"").trim();if(o)return o;const s=String((t==null?void 0:t.site)||"").trim();if(s)return s;const c=(r||[]).find(I=>String(I||"").toLowerCase().startsWith("site:"));return c?String(c).slice(5).trim():""}function Rr(e){return((e==null?void 0:e.tags)||[]).map(t=>String(t||"").trim()).filter(Boolean)}function Do(e){const t=String(e||"");return t.startsWith("group:")&&Ot.value.get(t.slice(6))||null}function et(e,t=null){return Ao(e,t,Rr(e))}function Mo(e,t=""){const r=Do((e==null?void 0:e.__originGroupKey)||t);return et(e,r)}function Br(e=[]){return ue.value==="all"?e:e.map(t=>{const r=(t.subgroups||[]).map(o=>({...o,items:(o.items||[]).filter(s=>et(s,t).toLowerCase()===ue.value)})).filter(o=>o.items.length>0);return r.length?{...t,subgroups:r}:null}).filter(Boolean)}function Oo(e){const t=String(e||"all").trim().toLowerCase(),r=new Set(pt.value.map(o=>o.value));ue.value=r.has(t)?t:"all"}function Nr(){R.value="",ee.value=0,Ee.value=!0}function Ft(){Ee.value=!1,R.value="",ee.value=0}function Go(){if(Ee.value){Ft();return}Nr()}function Ro(e){R.value=String(e||""),ee.value=0}function Bo(e){const t=Ye.value.length-1;if(t<0){ee.value=0;return}ee.value=Math.min(Math.max(e,0),t)}function No(e){const t=Ye.value.length;if(!t){ee.value=0;return}const o=(ee.value+e+t)%t;ee.value=o}function Vo(e){e&&(e.pageId&&(V.value=e.pageId),Kt(e.groupKey,e.subgroupId,e.item.id))}function Vr(e){e&&(Vo(e),qt(e.item),Ft())}function Ho(){Vr(Sr.value)}async function Fo(e){var t;(t=e==null?void 0:e.item)!=null&&t.url&&await tn(e.item.url)}function Ko(e){ce[e]=!Fr(e),S.groupKey=e,S.subgroupId="",S.itemId=""}function Hr(e,t){ce[e]=!0,S.groupKey=e,S.subgroupId=t,S.itemId=""}function Kt(e,t,r){ce[e]=!0,S.groupKey=e,S.subgroupId=t,S.itemId=r}function Fr(e){return!!ce[e]}function Kr(e){return S.groupKey===e&&!S.subgroupId&&!S.itemId}function Ur(e,t){return S.groupKey===e&&S.subgroupId===t&&!S.itemId}function Uo(e){return S.itemId===e}function jo(e=[]){const t=Ht(e),r=Br(t),o=ft.value?r:qo(r),s=Qo(o),c=s.length;return s.map(I=>({...I,__visibleCount:c}))}function zo(){return!!(S.groupKey||S.subgroupId||S.itemId)}function Wo(e){return String(e||"").trim()||"Без тега"}function jr(e){const t=new Set(Rr(e).map(r=>Wo(r)).filter(Boolean));return t.size||t.add("Без тега"),Array.from(t)}function Ut(e,t,r){return{...e,__originGroupKey:t,__originSubgroupId:r}}function qo(e=[]){return zo()?e.map(t=>{if(S.groupKey&&t.key!==S.groupKey)return null;let r=t.subgroups||[];return S.subgroupId&&(r=r.filter(o=>o.id===S.subgroupId)),S.itemId&&(r=r.map(o=>({...o,items:(o.items||[]).filter(s=>s.id===S.itemId)})).filter(o=>o.items.length>0)),r.length?{...t,subgroups:r}:null}).filter(Boolean):e}function Jo(e=[]){return e.map(t=>{const r=new Map;for(const c of t.subgroups||[])for(const I of c.items||[])for(const _ of jr(I))r.has(_)||r.set(_,[]),r.get(_).push(Ut(I,t.key,c.id));const s=Array.from(r.entries()).sort(([c],[I])=>c.localeCompare(I,"ru",{sensitivity:"base"})).map(([c,I])=>({id:`tag-${at(`${t.id}-${c}`,"tag")}`,title:`#${c}`,icon:"tag",items:I}));return s.length?{...t,subgroups:s}:null}).filter(Boolean)}function Yo(e=[]){const t=new Map;for(const o of e)for(const s of o.subgroups||[])for(const c of s.items||[])for(const I of jr(c))t.has(I)||t.set(I,[]),t.get(I).push(Ut(c,o.key,s.id));return Array.from(t.entries()).sort(([o],[s])=>o.localeCompare(s,"ru",{sensitivity:"base"})).map(([o,s])=>{const c=at(o,"tag");return{key:`tags:${c}`,id:`tags-${c}`,title:`#${o}`,icon:"tag",description:"Сервисы, сгруппированные только по тегам.",layout:"inline",subgroups:[{id:`tags-${c}-items`,title:"Сервисы",items:s}]}})}function zr(e=[]){const t=[];for(const r of e)for(const o of r.subgroups||[])for(const s of o.items||[])t.push(Ut(s,r.key,o.id));return t.length?[{key:"flat:all",id:"flat-all",title:"Все сервисы",icon:"layout-grid",description:"Плоское отображение без группировки.",layout:"full",subgroups:[{id:"flat-all-items",title:"Плитка",items:t}]}]:[]}function Qo(e=[]){return ft.value?zr(e):he.value==="tags_in_groups"?Jo(e):he.value==="tags"?Yo(e):he.value==="flat"?zr(e):e}function Xo(e){const t=String((e==null?void 0:e.layout)||"auto").toLowerCase();return t==="inline"?!0:t==="full"?!1:Number((e==null?void 0:e.__visibleCount)||0)>1}function Zo(e){return(e.subgroups||[]).reduce((t,r)=>t+(r.items||[]).length,0)}function ei(e){return((e==null?void 0:e.items)||[]).length}function ti(e){var r;let t=0;for(const o of e.subgroups||[])for(const s of o.items||[])(r=tt(s.id))!=null&&r.ok&&(t+=1);return t}function Wr(){for(const e of Object.keys(Je))delete Je[e]}function jt(e){return Vs(e)}function zt(e){const t=jt(e==null?void 0:e.url);return t?`${String((e==null?void 0:e.id)||"")}|${t}`:""}function ri(e){const t=jt(e==null?void 0:e.url);if(!t)return"";const r=zt(e);return r&&Je[r]?"":`${t}/favicon.ico`}function ni(e){const t=zt(e);t&&(Je[t]=!0)}function oi(e){return Ms(e)}function ii(e){return Os(e)}function si(e){return Gs(e)}function ai(e){return Rs(e)}function li(e){return Bs(e)}function Re(e){return Ie[e]||null}function Wt(e,t){return`${e}:${t}`}function ui(e,t){return!!ut[Wt(e,t)]}function _e(e,t){if(!t||typeof t!="string")return null;if(t==="$")return e;if(!t.startsWith("$."))return null;let r=e;const o=t.slice(2).split(".");for(const s of o){if(r==null)return null;const c=s.match(/^(.*)\[\*\]$/);if(c){const I=c[1],_=I?r==null?void 0:r[I]:r;return Array.isArray(_)?_:[]}r=r==null?void 0:r[s]}return r}function ci(e){var o,s,c;const t=(o=Re(e.id))==null?void 0:o.payload;return _e(t,(c=(s=e.data)==null?void 0:s.mapping)==null?void 0:c.value)??"—"}function di(e){var o,s,c;const t=(o=Re(e.id))==null?void 0:o.payload;return _e(t,(c=(s=e.data)==null?void 0:s.mapping)==null?void 0:c.subtitle)??""}function fi(e){var o,s,c;const t=(o=Re(e.id))==null?void 0:o.payload;return _e(t,(c=(s=e.data)==null?void 0:s.mapping)==null?void 0:c.trend)??""}function qr(e){var s,c;const t=(s=Re(e.id))==null?void 0:s.payload,r=((c=e.data)==null?void 0:c.mapping)||{},o=_e(t,r.items);return Array.isArray(o)?o.map(I=>{const _=_e(I,r.item_title)??"-",j=_e(I,r.item_value)??"-";return{title:_,value:j}}):[]}function pi(e){var s,c,I;const t=(s=Re(e.id))==null?void 0:s.payload,r=(I=(c=e.data)==null?void 0:c.mapping)==null?void 0:I.rows,o=_e(t,r);return Array.isArray(o)?o:Array.isArray(t)?t:Array.isArray(t==null?void 0:t.items)?t.items:[]}function bt(e){return e?e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/")?e:`/${e}`:""}function yt(){for(const e of ct.values())clearInterval(e);ct.clear()}function ht(){ze&&(clearInterval(ze),ze=0)}function tt(e){return qe[e]||null}function gi(e){return!!(e!=null&&e.ok&&e.latency_ms!=null&&e.latency_ms>=d)}function Jr(e){if(!e)return"unknown";const t=String(e.level||"").toLowerCase();return["online","degraded","down","unknown","indirect_failure"].includes(t)?t:gi(e)?"degraded":e.ok?"online":"down"}function mi(e){const t=tt(e),r=Jr(t);return r==="online"?"ok":r==="degraded"?"degraded":r==="down"||r==="indirect_failure"?"down":"unknown"}function vi(e){const t=tt(e);if(!t)return"Проверка...";const r=Jr(t);return r==="online"?t.latency_ms!=null?`Online • ${t.latency_ms} ms`:"Online":r==="degraded"?t.latency_ms!=null?`Degraded • ${t.latency_ms} ms`:t.status_code!=null?`Degraded • HTTP ${t.status_code}`:t.error?`Degraded • ${t.error}`:t.reason?`Degraded • ${String(t.reason).replaceAll("_"," ")}`:"Degraded":r==="indirect_failure"?"Indirect failure":r==="down"?t.error?`Offline • ${t.error}`:t.status_code!=null?`Offline • HTTP ${t.status_code}`:"Offline":"Unknown"}async function Be(e=null){const t=Array.isArray(e)&&e.length?e:Gt.value,r=Array.from(new Set(t.map(o=>String(o||"").trim()).filter(Boolean)));if(r.length)try{const o=await Cs(r);for(const s of o.items||[])qe[s.item_id]=s}catch{for(const o of r)qe[o]||(qe[o]={item_id:o,ok:!1,checked_url:"",status_code:null,latency_ms:null,error:"healthcheck unavailable"})}}async function Yr(){ht(),await Be(),ze=window.setInterval(()=>{Be()},l)}async function It(e){var s;const t=gt.value.get(e);if(!t)return;const r=bt((s=t.data)==null?void 0:s.endpoint);if(!r)return;Ie[e]||(Ie[e]={loading:!1,error:"",payload:null,lastUpdated:0});const o=Ie[e];o.loading=!0,o.error="";try{o.payload=await Ce(r),o.lastUpdated=Date.now()}catch(c){o.error=(c==null?void 0:c.message)||"Ошибка загрузки виджета"}finally{o.loading=!1}}async function Qr(){var t,r;yt();const e=[];for(const o of Dt.value){if(e.push(It(o.id)),!bt((t=o.data)==null?void 0:t.endpoint))continue;const s=Math.max(1,Number(((r=o.data)==null?void 0:r.refresh_sec)||0))*1e3,c=window.setInterval(()=>{It(o.id)},s);ct.set(o.id,c)}await Promise.all(e)}async function bi(e,t){const r=Wt(e,t.id),o=bt(t.endpoint);if(o){ut[r]=!0;try{await Ce(o,{method:String(t.method||"GET").toUpperCase()}),await It(e)}catch(s){Ie[e]||(Ie[e]={loading:!1,error:"",payload:null,lastUpdated:0}),Ie[e].error=(s==null?void 0:s.message)||"Не удалось выполнить действие"}finally{ut[r]=!1}}}async function Xr(){var e,t,r;M.value=!0,A.value="",Y.value="idle",Q.value="",Wr();try{const o=await ks();h.value=o,(!V.value||!we.value.some(s=>s.id===V.value))&&(V.value=((e=we.value[0])==null?void 0:e.id)||""),Ze(),Xe(),Cr((t=o==null?void 0:o.ui)==null?void 0:t.theme),Tr((r=o==null?void 0:o.ui)==null?void 0:r.grid),await Qr(),await Yr()}catch(o){A.value=(o==null?void 0:o.message)||"Не удалось загрузить dashboard-конфигурацию",h.value=null,yt(),ht()}finally{M.value=!1}}async function Zr(e){var o,s,c,I,_,j;const t=!!(((c=(s=(o=h.value)==null?void 0:o.security)==null?void 0:s.iframe)==null?void 0:c.default_sandbox)??!0),r=(I=e==null?void 0:e.iframe)==null?void 0:I.sandbox;X.open=!0,X.title=e.title,X.src="",X.error="",X.loading=!0,X.sandbox=r==null?t:!!r,X.allow=Array.isArray((_=e==null?void 0:e.iframe)==null?void 0:_.allow)?e.iframe.allow.join("; "):"",X.referrerPolicy=((j=e==null?void 0:e.iframe)==null?void 0:j.referrer_policy)||"";try{const ne=await $s(e.id);X.src=ne.src}catch(ne){X.error=(ne==null?void 0:ne.message)||"Не удалось подготовить iframe"}finally{X.loading=!1}}function yi(){X.open=!1,X.title="",X.src="",X.error="",X.loading=!1,X.sandbox=!1,X.allow="",X.referrerPolicy=""}function en(e){if(e.open==="same_tab"){window.location.assign(e.url);return}window.open(e.url,"_blank","noopener,noreferrer")}function hi(e){e!=null&&e.url&&window.open(e.url,"_blank","noopener,noreferrer")}function qt(e){if(e.type==="iframe"){Zr(e);return}en(e)}function Jt(e){return wr.value.get(String(e||""))||""}async function Yt(e){var r;const t=String(e||"");if(t&&(r=navigator.clipboard)!=null&&r.writeText)try{await navigator.clipboard.writeText(t)}catch{}}async function tn(e){await Yt(e)}async function Ii(e){const t=Jt(e);t&&await Yt(t)}async function wi(e){const t=Jt(e);t&&await Yt(`ssh ${t}`)}async function Si(e){e&&await Be([e])}function _i(e){if(!e)return"—";const t=new Date(e);return Number.isNaN(t.getTime())?"—":t.toLocaleString("ru-RU",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function ki(e){const t=Number(e||0);return!Number.isFinite(t)||t<=0?"—":t<1e3?`${Math.round(t)} ms`:`${(t/1e3).toFixed(2)} s`}function $i(e){e&&(W.host=e,W.open=!0)}function Qt(){W.open=!1,W.host=null}function Ci(e){const t=(e==null?void 0:e.open_ports)||[];return t.length?t.map(r=>r!=null&&r.service?`${r.port} (${r.service})`:`${r.port}`).join(", "):"—"}function Ti(e){return e?e.error?e.error:e.status_code==null?"—":`HTTP ${e.status_code}`:"—"}async function wt({silent:e=!1}={}){if(!dt){dt=!0,e||(je.value=!0);try{se.value=await Es(),Te.value=""}catch(t){Te.value=(t==null?void 0:t.message)||"Не удалось загрузить состояние сканера LAN"}finally{dt=!1,e||(je.value=!1)}}}function St(){We&&(window.clearInterval(We),We=0)}function rn(){St(),We=window.setInterval(()=>{wt({silent:!0})},u)}async function Ei(){var e;if(!Me.value){Me.value=!0;try{const t=await Ls();se.value=(t==null?void 0:t.state)||se.value,Te.value=t!=null&&t.accepted||(e=t==null?void 0:t.state)!=null&&e.queued?"":(t==null?void 0:t.message)||""}catch(t){Te.value=(t==null?void 0:t.message)||"Не удалось запустить сканирование LAN"}finally{Me.value=!1,wt({silent:!0})}}}function Li(){var e,t;return((t=(e=document.documentElement)==null?void 0:e.dataset)==null?void 0:t.fxMode)||"full"}function Pi(e){const t=Li();if(t==="off")return null;const r=JSON.parse(JSON.stringify(e));return t!=="lite"||(r.particles.number.value=Math.max(24,Math.round(r.particles.number.value*.56)),r.particles.opacity.value=Number((r.particles.opacity.value*.72).toFixed(2)),r.particles.move.speed=Number((r.particles.move.speed*.74).toFixed(2)),r.particles.line_linked.opacity=Number((r.particles.line_linked.opacity*.56).toFixed(2)),r.particles.line_linked.distance=Math.max(80,Math.round(r.particles.line_linked.distance*.84))),r}async function _t(e,t){const r=document.getElementById(e);if(!r)return;const o=Pi(t);if(!o){r.innerHTML="",delete r.dataset.particlesReady;return}r.dataset.particlesReady==="1"||!await Ds()||!window.particlesJS||document.getElementById(e)&&r.dataset.particlesReady!=="1"&&(r.innerHTML="",window.particlesJS(e,o),r.dataset.particlesReady="1")}async function nn(){await _t(y,C)}async function kt(){await Promise.all([_t(w,v),_t(k,v)])}return $e(()=>{var e;return(e=Se.value)==null?void 0:e.id},async()=>{re.value="",te.value="",Ze(),Xe(),Be(),await Xt(),await kt()}),$e(()=>{var e;return(e=$r.value)==null?void 0:e.id},async()=>{await Xt(),await kt()}),$e(()=>mt.value,e=>{re.value&&!e.includes(re.value)&&(re.value="")},{deep:!0}),$e(()=>Oe.value,()=>{Xe(),Be()},{deep:!0}),$e(()=>Ye.value.length,e=>{if(!e){ee.value=0;return}ee.value>=e&&(ee.value=e-1)}),$e(()=>pt.value.map(e=>e.value).join("|"),()=>{pt.value.some(e=>e.value===ue.value)||(ue.value="all")}),$e(()=>_r.value,e=>{if(e){wt(),rn();return}Qt(),St()}),At(async()=>{await nn(),await Xr(),await Xt(),await kt()}),lt(()=>{yt(),ht(),St(),Qt(),Le&&(clearTimeout(Le),Le=0),it=null}),it={BRAND_ICON_BY_KEY:Lt,DEFAULT_ITEM_URL:m,EMBLEM_SRC:n,HEALTH_REFRESH_MS:l,HERO_CONTROLS_PARTICLES_ID:k,HERO_PARTICLES_CONFIG:v,HERO_TITLE_PARTICLES_ID:w,ICON_BY_KEY:Pt,ICON_RULES:Nn,LAN_PAGE_ID:a,LAN_SCAN_POLL_MS:u,LARGE_INDICATOR_TYPES:p,SIDEBAR_PARTICLES_CONFIG:C,SIDEBAR_PARTICLES_ID:y,actionBusy:ut,actionKey:Wt,activeCommandPaletteEntry:Sr,activeIndicatorViewId:re,activeIndicatorWidget:$r,activePage:Se,activePageGroupBlocks:to,activePageId:V,activePageWidgetIds:mt,addGroup:uo,addItem:fo,addSubgroup:co,allItemIds:Ct,allSubgroupIds:xt,appTagline:Kn,appTitle:Fn,applyConfigMutation:ae,applyGrid:Tr,applyTheme:Cr,authProfileOptions:gr,buildDefaultItem:Bt,buildItemFromEditorForm:Dr,clampNumber:Vt,clearDragState:Ge,clearItemFaviconFailures:Wr,clearSelectedNode:Ze,cloneConfig:Er,closeIframeModal:yi,closeItemEditor:Pr,closeLanHostModal:Qt,closeCommandPalette:Ft,commandPaletteActiveIndex:ee,commandPaletteOpen:Ee,commandPaletteQuery:R,commandPaletteResults:Ye,config:h,configError:A,copyItemIp:Ii,copyItemSshShortcut:wi,copyCommandPaletteEntryUrl:Fo,copyUrl:tn,createBrandIcon:x,defaultItemEditorForm:U,dragState:L,editGroup:go,editItem:vo,editMode:B,editSubgroup:mo,ensureAbsoluteUrl:Rt,ensurePageGroupsReference:In,expandedGroups:ce,faviconOriginFromUrl:jt,filteredBlockGroups:jo,filteredTreeGroups:kr,findGroup:me,findSubgroup:de,formatLanDuration:ki,formatLanHttpStatus:Ti,formatLanMoment:_i,fromToken:Hn,groupById:Ot,groupOnlineItems:ti,groupTotalItems:Zo,healthClass:mi,healthLabel:vi,healthPollTimer:ze,healthState:tt,healthStates:qe,iframeModal:X,indicatorPreviewEntries:Lo,initHeroParticles:kt,initParticles:_t,initSidebarParticles:nn,initWidgetPolling:Qr,isActionBusy:ui,isDirectGroupNode:Tt,isGroupExpanded:Fr,isGroupSelected:Kr,isIconCardView:mr,isSidebarDetailed:Mt,isSidebarSectionsOnly:yr,isSidebarHidden:ft,isTileCardView:vr,isCompactServiceCardView:br,isInlineGroupLayout:Xo,isItemSelected:Uo,isLanPage:_r,isLargeIndicator:Qe,isSidebarIconActive:io,isSidebarIconOnly:zn,isSubgroupSelected:Ur,isWidgetBlock:Mr,itemEditor:$,itemFaviconFailures:Je,itemFaviconKey:zt,itemFaviconSrc:ri,itemIp:Jt,itemSite:Mo,lanCidrsLabel:qn,lanHostModal:W,lanHosts:hr,lanPortsLabel:Ci,lanScanActionBusy:Me,lanScanError:Te,lanScanLoading:je,lanScanPollTimer:We,lanScanRefreshInFlight:dt,lanScanState:se,loadConfig:Xr,loadingConfig:M,makeUniqueId:xe,markItemFaviconFailed:ni,moveGroup:wn,moveCommandPaletteSelection:No,moveItemBefore:_n,moveItemToSubgroupEnd:kn,moveSubgroup:Sn,normalizeEndpoint:bt,normalizeIconToken:Vn,normalizeId:at,normalizeLayoutBlocks:hn,normalizeStringList:Nt,onGroupDragOver:_o,onGroupDragStart:Io,onGroupDrop:ko,onItemCardClick:lo,onItemDragOver:To,onItemDragStart:So,onItemDrop:Eo,onSubgroupDragOver:$o,onSubgroupDragStart:wo,onSubgroupDrop:Co,activateCommandPaletteEntry:Vr,activateCommandPaletteSelection:Ho,openCommandPalette:Nr,openCreateItemEditor:xr,openEditItemEditor:Ar,openIframeItem:Zr,openIndicatorView:Gr,openItem:qt,openItemInNewTab:hi,openLanHostModal:$i,openLinkItem:en,pageHealthSummary:Zn,pages:we,persistConfig:Lr,pickSemanticIcon:Ue,refreshHealth:Be,recheckItem:Si,refreshLanScanState:wt,refreshWidget:It,removeGroup:bo,removeItem:ho,removeSubgroup:yo,resetWidgetPolling:yt,resolveBlockGroups:Ht,resolveExpression:_e,resolveGroupIcon:ii,resolveItemIcon:ai,resolvePageIcon:oi,resolveSubgroupIcon:si,resolveWidgetIcon:li,resolveWidgets:Or,runLanScanNow:Ei,runWidgetAction:bi,saveError:Q,saveStatus:Y,saveStatusLabel:Jn,saveStatusTimer:Le,setCommandPaletteActiveIndex:Bo,setCommandPaletteQuery:Ro,setSiteFilter:Oo,sidebarViewToggleTitle:Wn,selectItemNode:Kt,selectSidebarIconNode:ao,selectSidebarIndicator:Po,selectSubgroupNode:Hr,selectedNode:S,serviceCardView:z,siteFilter:ue,siteFilterOptions:pt,serviceGroupingMode:he,serviceGroupingOptions:jn,servicePresentationOptions:Un,sidebarIconNodeTitle:so,sidebarIconNodes:Xn,sidebarIndicatorSummary:eo,sidebarIndicators:vt,sidebarView:pe,startHealthPolling:Yr,startLanScanPolling:rn,statCardSubtitle:di,statCardTrend:fi,statCardValue:ci,statListEntries:qr,statsExpanded:De,stopHealthPolling:ht,stopLanScanPolling:St,subgroupById:Ir,subgroupTotalItems:ei,submitItemEditor:po,syncTreeGroupsState:Xe,tableRows:pi,toggleCommandPalette:Go,toggleEditMode:ro,toggleGroupNode:Ko,toggleServiceCardView:no,toggleSidebarView:oo,treeFilter:te,treeGroups:Oe,visibleTreeItemIds:Gt,widgetById:gt,widgetIntervals:ct,widgetState:Re,widgetStates:Ie,widgets:Dt},it}const Hs=["title"],Fs={key:0,class:"item-compact-body"},Ks=["src"],Us={class:"item-tile-head"},js=["src"],zs={class:"item-tile-title"},Ws={class:"item-head"},qs={class:"item-title-row"},Js=["src"],Ys={class:"item-type"},Qs={class:"item-url"},Xs={class:"item-health"},Zs={key:0,class:"item-tags"},ea={key:0,class:"tag-pill site-pill"},ta={class:"item-actions"},ra={key:1,class:"item-ssh-shortcut"},na={__name:"ServiceItemCard",props:{groupKey:{type:String,required:!0},subgroupId:{type:String,required:!0},item:{type:Object,required:!0}},setup(n){const l=n,d=Zt(l,"groupKey"),u=Zt(l,"subgroupId"),a=Zt(l,"item"),p=le(),{isIconCardView:m,isTileCardView:y,isCompactServiceCardView:w,isItemSelected:k,onItemCardClick:C,itemFaviconSrc:v,markItemFaviconFailed:E,resolveItemIcon:O,healthClass:J,healthLabel:ie,itemIp:G,itemSite:U,copyItemIp:h,copyItemSshShortcut:M,openItem:A,openItemInNewTab:V,recheckItem:te,copyUrl:De}=p,re=T(()=>J(a.value.id)),B=T(()=>ie(a.value.id)),z=T(()=>G(a.value.id)),he=T(()=>`ssh ${z.value}`),ue=T(()=>U(a.value,d.value)),pe=H(!1),Y=H(!1);let Q=0,se=0;const je=T(()=>({selected:!w.value&&k(a.value.id),compact:w.value,tile:y.value,[`status-${re.value}`]:!0,"data-updated":Y.value}));function Me(){Q&&clearTimeout(Q),pe.value=!1,window.requestAnimationFrame(()=>{pe.value=!0,Q=window.setTimeout(()=>{pe.value=!1,Q=0},900)})}function Te(){se&&clearTimeout(se),Y.value=!1,window.requestAnimationFrame(()=>{Y.value=!0,se=window.setTimeout(()=>{Y.value=!1,se=0},1250)})}return $e([re,B],([Ee,R],[ee,W])=>{ee===void 0&&W===void 0||((Ee!==ee||R!==W)&&Te(),R!==W&&Me())}),lt(()=>{Q&&(clearTimeout(Q),Q=0),se&&(clearTimeout(se),se=0)}),(Ee,R)=>{var ee;return f(),b("article",{class:N(["item-card",je.value]),title:i(w)?a.value.title:void 0,onClick:R[9]||(R[9]=W=>i(C)(d.value,u.value,a.value))},[i(m)?(f(),b("div",Fs,[i(v)(a.value)?(f(),b("img",{key:0,src:i(v)(a.value),class:"service-favicon compact-item-favicon",alt:"",loading:"lazy",referrerpolicy:"no-referrer",onError:R[0]||(R[0]=W=>i(E)(a.value))},null,40,Ks)):(f(),F(be(i(O)(a.value)),{key:1,class:"ui-icon item-icon compact-item-icon"})),g("span",{class:N(["health-dot compact-health-dot",re.value])},null,2)])):i(y)?(f(),b(Z,{key:1},[g("div",Us,[i(v)(a.value)?(f(),b("img",{key:0,src:i(v)(a.value),class:"service-favicon tile-item-favicon",alt:"",loading:"lazy",referrerpolicy:"no-referrer",onError:R[1]||(R[1]=W=>i(E)(a.value))},null,40,js)):(f(),F(be(i(O)(a.value)),{key:1,class:"ui-icon item-icon tile-item-icon"})),g("span",{class:N(["health-dot tile-health-dot",re.value])},null,2)]),g("p",zs,D(a.value.title),1)],64)):(f(),b(Z,{key:2},[g("div",Ws,[g("div",qs,[i(v)(a.value)?(f(),b("img",{key:0,src:i(v)(a.value),class:"service-favicon item-favicon",alt:"",loading:"lazy",referrerpolicy:"no-referrer",onError:R[2]||(R[2]=W=>i(E)(a.value))},null,40,Js)):(f(),F(be(i(O)(a.value)),{key:1,class:"ui-icon item-icon"})),g("h4",null,D(a.value.title),1)]),g("span",Ys,D(a.value.type),1)]),g("p",Qs,D(a.value.url),1),g("div",Xs,[g("span",{class:N(["health-dot",re.value])},null,2),g("span",{class:N(["health-text",{"is-updating":pe.value}])},D(B.value),3)]),ue.value||(ee=a.value.tags)!=null&&ee.length?(f(),b("div",Zs,[ue.value?(f(),b("span",ea,"site:"+D(ue.value),1)):K("",!0),(f(!0),b(Z,null,fe(a.value.tags,W=>(f(),b("span",{key:W,class:"tag-pill"},D(W),1))),128))])):K("",!0),g("div",ta,[P(ve,{title:a.value.type==="iframe"?"Открыть iframe":"Открыть","aria-label":a.value.type==="iframe"?"Открыть iframe":"Открыть",onClick:R[3]||(R[3]=q(W=>i(A)(a.value),["stop"]))},{default:oe(()=>[(f(),F(be(a.value.type==="iframe"?i(cr):i(dr)),{class:"ui-icon item-action-icon"}))]),_:1},8,["title","aria-label"]),P(ve,{title:"Открыть в новой вкладке","aria-label":"Открыть в новой вкладке",onClick:R[4]||(R[4]=q(W=>i(V)(a.value),["stop"]))},{default:oe(()=>[P(i(us),{class:"ui-icon item-action-icon"})]),_:1}),P(ve,{title:"Recheck health","aria-label":"Recheck health",onClick:R[5]||(R[5]=q(W=>i(te)(a.value.id),["stop"]))},{default:oe(()=>[P(i(cs),{class:"ui-icon item-action-icon"})]),_:1}),z.value?(f(),F(ve,{key:0,title:"Копировать IP","aria-label":"Копировать IP",onClick:R[6]||(R[6]=q(W=>i(h)(a.value.id),["stop"]))},{default:oe(()=>[P(i(Ae),{class:"ui-icon item-action-icon"})]),_:1})):K("",!0),z.value?(f(),F(ve,{key:1,title:"Копировать SSH shortcut","aria-label":"Копировать SSH shortcut",onClick:R[7]||(R[7]=q(W=>i(M)(a.value.id),["stop"]))},{default:oe(()=>[P(i(An),{class:"ui-icon item-action-icon"})]),_:1})):K("",!0),P(ve,{title:"Копировать URL","aria-label":"Копировать URL",onClick:R[8]||(R[8]=q(W=>i(De)(a.value.url),["stop"]))},{default:oe(()=>[P(i(ds),{class:"ui-icon item-action-icon"})]),_:1})]),z.value?(f(),b("p",ra,[R[10]||(R[10]=Ai(" SSH: ",-1)),g("code",null,D(he.value),1)])):K("",!0)],64))],10,Hs)}}},oa={class:"group-header"},ia={class:"group-title-row"},sa={key:0,class:"subtitle"},aa={class:"subgroup-title"},la={__name:"ServiceGroupCard",props:{group:{type:Object,required:!0}},setup(n){const l=le(),{isInlineGroupLayout:d,resolveGroupIcon:u,resolveSubgroupIcon:a,isIconCardView:p,isTileCardView:m}=l;return(y,w)=>(f(),b("article",{class:N(["panel group-panel",{"group-panel-inline":i(d)(n.group)}])},[g("header",oa,[g("div",ia,[(f(),F(be(i(u)(n.group)),{class:"ui-icon group-icon"})),g("h2",null,D(n.group.title),1)]),n.group.description?(f(),b("p",sa,D(n.group.description),1)):K("",!0)]),(f(!0),b(Z,null,fe(n.group.subgroups,k=>(f(),b("section",{key:k.id,class:"subgroup"},[g("h3",aa,[(f(),F(be(i(a)(k)),{class:"ui-icon subgroup-icon"})),g("span",null,D(k.title),1)]),P(Di,{name:"item-grid-transition",tag:"div",class:N(["item-grid",{"icon-card-grid":i(p),"tile-card-grid":i(m)}])},{default:oe(()=>[(f(!0),b(Z,null,fe(k.items,C=>(f(),F(na,{key:C.id,"group-key":C.__originGroupKey||n.group.key,"subgroup-id":C.__originSubgroupId||k.id,item:C},null,8,["group-key","subgroup-id","item"]))),128))]),_:2},1032,["class"])]))),128))],2))}},ua={class:"page-stack"},ca={class:"groups-grid"},da={key:0,class:"panel group-panel group-empty"},fa={key:0,class:"panel group-panel group-empty"},pa={__name:"ServicesGroupsPanel",setup(n){const l=le(),{activePage:d,activePageGroupBlocks:u,filteredBlockGroups:a}=l;return(p,m)=>(f(),b("section",ua,[(f(!0),b(Z,null,fe(i(u),(y,w)=>(f(),b("section",{key:`${i(d).id}:${w}:groups`,class:"block-wrap"},[g("section",ca,[(f(!0),b(Z,null,fe(i(a)(y.group_ids),k=>(f(),F(la,{key:k.key,group:k},null,8,["group"]))),128)),i(a)(y.group_ids).length?K("",!0):(f(),b("article",da,[...m[0]||(m[0]=[g("h2",null,"Нет данных для выбранного узла",-1),g("p",{class:"subtitle"},"Выберите другую ветку в боковом дереве.",-1)])]))])]))),128)),i(u).length?K("",!0):(f(),b("article",fa,[...m[1]||(m[1]=[g("h2",null,"Для этой страницы нет групп",-1),g("p",{class:"subtitle"},"Откройте нужный индикатор в аккордеоне слева.",-1)])]))]))}},ga=["aria-label","aria-expanded","disabled"],ma={class:"hero-dropdown-label"},va={class:"hero-dropdown-value"},ba=["aria-label"],ya=["aria-selected"],ha=["onClick"],ir={__name:"HeroDropdown",props:{modelValue:{type:String,default:""},label:{type:String,default:""},ariaLabel:{type:String,default:""},options:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:l}){const d=n,u=l,a=H(!1),p=H(null),m=T(()=>{var E;const v=d.options.find(O=>O.value===d.modelValue);return v?v.label:((E=d.options[0])==null?void 0:E.label)||""});function y(){d.disabled||(a.value=!a.value)}function w(v){u("update:modelValue",v),a.value=!1}function k(v){a.value&&p.value&&!p.value.contains(v.target)&&(a.value=!1)}function C(v){v.key==="Escape"&&(a.value=!1)}return At(()=>{window.addEventListener("pointerdown",k),window.addEventListener("keydown",C)}),lt(()=>{window.removeEventListener("pointerdown",k),window.removeEventListener("keydown",C)}),(v,E)=>(f(),b("div",{ref_key:"rootRef",ref:p,class:"hero-dropdown"},[g("button",{class:"hero-dropdown-trigger",type:"button","aria-label":n.ariaLabel||n.label,"aria-haspopup":"listbox","aria-expanded":a.value,disabled:n.disabled,onClick:y},[$n(v.$slots,"prefix",{},()=>[g("span",ma,D(n.label),1)]),g("span",va,D(m.value),1),P(i(fs),{class:N(["ui-icon hero-dropdown-caret",{open:a.value}])},null,8,["class"])],8,ga),P(Cn,{name:"hero-dropdown-menu-transition"},{default:oe(()=>[a.value?(f(),b("ul",{key:0,class:"hero-dropdown-menu",role:"listbox","aria-label":n.ariaLabel||n.label},[(f(!0),b(Z,null,fe(n.options,O=>(f(),b("li",{key:O.value,role:"option","aria-selected":n.modelValue===O.value},[g("button",{class:N(["hero-dropdown-option",{active:n.modelValue===O.value}]),type:"button",onClick:J=>w(O.value)},[g("span",null,D(O.label),1),n.modelValue===O.value?(f(),F(i(ps),{key:0,class:"ui-icon hero-dropdown-check"})):K("",!0)],10,ha)],8,ya))),128))],8,ba)):K("",!0)]),_:1})],512))}},Ia=["title","aria-label","aria-selected","onClick"],wa={class:"hero-page-tab-label"},Sa={__name:"HeroPageTabs",setup(n){let l=!1;const d=le(),{pages:u,activePage:a,activePageId:p,resolvePageIcon:m}=d,y=H(!l);let w=0;return At(()=>{y.value&&(w=globalThis.setTimeout(()=>{y.value=!1,l=!0},700))}),lt(()=>{w&&(globalThis.clearTimeout(w),w=0),y.value&&(l=!0)}),(k,C)=>(f(),b("nav",{class:N(["hero-page-tabs",{"hero-page-tabs--intro":y.value}]),role:"tablist","aria-label":"Разделы"},[(f(!0),b(Z,null,fe(i(u),v=>{var E,O,J;return f(),b("button",{key:v.id,class:N(["hero-page-tab-btn",{active:((E=i(a))==null?void 0:E.id)===v.id,"hero-page-tab-btn--intro-active":y.value&&((O=i(a))==null?void 0:O.id)===v.id}]),type:"button",role:"tab",title:v.title,"aria-label":v.title,"aria-selected":((J=i(a))==null?void 0:J.id)===v.id,onClick:ie=>p.value=v.id},[(f(),F(be(i(m)(v)),{class:"ui-icon hero-page-tab-icon"})),g("span",wa,D(v.title),1)],10,Ia)}),128))],2))}},_a={class:"hero-layout"},ka={class:"hero panel hero-title-panel"},$a={class:"hero-title-content"},Ca={class:"hero-controls-content"},Ta={key:0,id:"hero-controls-drawer",class:"hero-controls-drawer"},Ea={class:"hero-display-controls"},La=["title","aria-label"],Pa=["aria-expanded","title"],xa={key:0,class:"editor-error hero-editor-error"},Aa={__name:"ServicesHeroPanel",setup(n){const l=le(),d=H(!1),{editMode:u,isSidebarDetailed:a,isSidebarHidden:p,saveStatus:m,saveStatusLabel:y,saveError:w,sidebarViewToggleTitle:k,serviceCardView:C,serviceGroupingMode:v,serviceGroupingOptions:E,servicePresentationOptions:O,siteFilter:J,siteFilterOptions:ie,toggleEditMode:G,addGroup:U,openCommandPalette:h,toggleSidebarView:M}=l;return(A,V)=>(f(),b("section",_a,[g("header",ka,[V[4]||(V[4]=g("div",{id:"hero-title-particles",class:"hero-panel-particles","aria-hidden":"true"},null,-1)),g("div",$a,[P(Sa)])]),g("aside",{class:N(["panel hero-control-panel service-hero-controls",{active:i(u)}])},[V[5]||(V[5]=g("div",{id:"hero-controls-particles",class:"hero-panel-particles","aria-hidden":"true"},null,-1)),g("div",Ca,[g("div",{class:N(["hero-controls-accordion",{open:d.value}])},[P(Cn,{name:"hero-controls-drawer-transition"},{default:oe(()=>[d.value?(f(),b("div",Ta,[P(ve,{"button-class":"hero-icon-btn hero-accordion-action editor-toggle",active:i(u),title:i(u)?"Выключить режим редактирования":"Включить режим редактирования","aria-label":i(u)?"Выключить режим редактирования":"Включить режим редактирования",onClick:i(G)},{default:oe(()=>[P(i(fr),{class:"ui-icon hero-action-icon"})]),_:1},8,["active","title","aria-label","onClick"]),i(u)?(f(),F(ve,{key:0,"button-class":"hero-icon-btn hero-accordion-action",title:"Добавить группу","aria-label":"Добавить группу",onClick:i(U)},{default:oe(()=>[P(i(pr),{class:"ui-icon hero-action-icon"})]),_:1},8,["onClick"])):K("",!0),g("div",Ea,[P(ir,{modelValue:i(C),"onUpdate:modelValue":V[0]||(V[0]=te=>er(C)?C.value=te:null),label:"Вид","aria-label":"Режим отображения сервисов",options:i(O)},null,8,["modelValue","options"]),P(ir,{modelValue:i(v),"onUpdate:modelValue":V[1]||(V[1]=te=>er(v)?v.value=te:null),label:"","aria-label":"Группировка сервисов",options:i(E),disabled:i(p)},{prefix:oe(()=>[P(i(lr),{class:"ui-icon hero-dropdown-prefix-icon","aria-hidden":"true"})]),_:1},8,["modelValue","options","disabled"]),P(ir,{modelValue:i(J),"onUpdate:modelValue":V[2]||(V[2]=te=>er(J)?J.value=te:null),label:"Site","aria-label":"Фильтр по площадке",options:i(ie)},{prefix:oe(()=>[P(i(gs),{class:"ui-icon hero-dropdown-prefix-icon","aria-hidden":"true"})]),_:1},8,["modelValue","options"])]),P(ve,{"button-class":"hero-icon-btn hero-accordion-action",title:"Быстрый поиск сервисов (Ctrl/Cmd+K)","aria-label":"Быстрый поиск сервисов",onClick:i(h)},{default:oe(()=>[P(i(ms),{class:"ui-icon hero-action-icon"})]),_:1},8,["onClick"]),P(ve,{"button-class":"hero-icon-btn hero-accordion-action",active:!i(a),title:i(k),"aria-label":i(k),onClick:i(M)},{default:oe(()=>[P(i(Gn),{class:"ui-icon hero-action-icon"})]),_:1},8,["active","title","aria-label","onClick"]),i(u)?(f(),b("span",{key:1,class:N(["hero-save-indicator hero-accordion-status",i(m)]),role:"status",title:i(y),"aria-label":i(y)},[P(i(vs),{class:"ui-icon hero-save-icon"})],10,La)):K("",!0)])):K("",!0)]),_:1}),g("button",{class:"hero-controls-trigger",type:"button","aria-expanded":d.value,"aria-controls":"hero-controls-drawer",title:d.value?"Скрыть панель действий":"Показать панель действий",onClick:V[3]||(V[3]=te=>d.value=!d.value)},[P(i(Mn),{class:"ui-icon hero-action-icon"}),P(i(bs),{class:N(["ui-icon hero-accordion-caret",{open:d.value}])},null,8,["class"])],8,Pa)],2),i(u)&&i(w)?(f(),b("p",xa,D(i(w)),1)):K("",!0)])],2)]))}},Da={key:0,class:"panel status-panel"},Ma={key:1,class:"panel status-panel error-state"},Oa={class:"subtitle"},Ga={key:3,class:"panel status-panel"},Ra={__name:"DashboardMainView",setup(n){const l=Ve(()=>He(()=>import("./IndicatorTabPanel-Kxp2dxqr.js"),__vite__mapDeps([0,1,2]))),d=Ve(()=>He(()=>import("./LanPageView-BsRIh4m7.js"),__vite__mapDeps([3,1,2]))),u=le(),{activePage:a,activeIndicatorWidget:p,loadingConfig:m,configError:y,isLanPage:w,loadConfig:k}=u;return(C,v)=>{var E;return f(),b("main",{key:((E=i(a))==null?void 0:E.id)||"empty",class:N(["page",{"indicator-open":!!i(p),"page--lan":i(w)&&!i(p)}])},[i(m)?(f(),b("section",Da,[...v[1]||(v[1]=[g("h2",null,"Загрузка конфигурации...",-1),g("p",{class:"subtitle"},"Получаем dashboard-модель из backend.",-1)])])):i(y)?(f(),b("section",Ma,[v[2]||(v[2]=g("h2",null,"Ошибка загрузки конфигурации",-1)),g("p",Oa,D(i(y)),1),g("button",{class:"ghost",type:"button",onClick:v[0]||(v[0]=(...O)=>i(k)&&i(k)(...O))},"Повторить")])):i(a)?(f(),b(Z,{key:2},[i(p)?(f(),F(i(l),{key:0})):(f(),b(Z,{key:1},[i(w)?(f(),F(i(d),{key:0})):(f(),b(Z,{key:1},[P(Aa),P(pa)],64))],64))],64)):(f(),b("section",Ga,[...v[3]||(v[3]=[g("h2",null,"Нет доступных страниц",-1),g("p",{class:"subtitle"},"Проверьте `layout.pages` в `dashboard.yaml`.",-1)])]))],2)}}},Ba={class:"brand"},Na=["src"],Va={class:"brand-title"},Ha={class:"brand-subtitle"},Fa={__name:"SidebarHeaderTabs",setup(n){const l=le(),{EMBLEM_SRC:d,appTitle:u,appTagline:a}=l;return(p,m)=>(f(),b("div",Ba,[g("img",{src:i(d),alt:"Oko"},null,8,Na),g("div",null,[g("p",Va,D(i(u)),1),g("p",Ha,D(i(a)),1)])]))}},Ka={class:"sidebar-stats-accordion","aria-label":"Индикаторы"},Ua=["aria-expanded"],ja={class:"sidebar-stats-toggle-values"},za={key:0,class:"sidebar-indicators"},Wa=["onClick"],qa={class:"widget-head sidebar-indicator-head"},Ja={class:"widget-title"},Ya={class:"item-type"},Qa={key:0,class:"widget-error"},Xa={key:1,class:"widget-loading"},Za={class:"widget-value sidebar-indicator-value"},el={class:"widget-subtitle"},tl={key:0,class:"widget-trend"},rl={key:0,class:"widget-list sidebar-list-preview"},nl={key:1,class:"widget-empty"},ol={class:"widget-subtitle"},il={key:5,class:"widget-empty"},sl={key:6,class:"widget-actions sidebar-indicator-actions"},al=["onClick"],ll=["disabled","onClick"],ul={key:1,class:"widget-empty"},cl={__name:"SidebarIndicatorsAccordion",setup(n){const l=le(),{statsExpanded:d,sidebarIndicatorSummary:u,sidebarIndicators:a,isLargeIndicator:p,activeIndicatorWidget:m,selectSidebarIndicator:y,resolveWidgetIcon:w,widgetState:k,statCardValue:C,statCardSubtitle:v,statCardTrend:E,indicatorPreviewEntries:O,tableRows:J,openIndicatorView:ie,isActionBusy:G,runWidgetAction:U}=l;return(h,M)=>(f(),b("div",Ka,[g("button",{class:"sidebar-stats-toggle",type:"button","aria-controls":"sidebar-stats-panel","aria-expanded":i(d),onClick:M[0]||(M[0]=A=>d.value=!i(d))},[M[1]||(M[1]=g("span",{class:"sidebar-stats-toggle-text"},"Индикаторы",-1)),g("span",ja,D(i(u)),1),g("span",{class:N(["sidebar-stats-toggle-caret",{open:i(d)}])},"▴",2)],8,Ua),g("div",{id:"sidebar-stats-panel",class:N(["sidebar-stats-panel",{open:i(d)}])},[i(a).length?(f(),b("div",za,[(f(!0),b(Z,null,fe(i(a),A=>{var V,te,De,re,B;return f(),b("article",{key:A.id,class:N(["sidebar-indicator",{interactive:i(p)(A),active:((V=i(m))==null?void 0:V.id)===A.id}]),onClick:z=>i(y)(A)},[g("header",qa,[g("div",Ja,[(f(),F(be(i(w)(A)),{class:"ui-icon widget-icon"})),g("h3",null,D(A.title),1)]),g("span",Ya,D(A.type),1)]),(te=i(k)(A.id))!=null&&te.error?(f(),b("p",Qa,D((De=i(k)(A.id))==null?void 0:De.error),1)):(re=i(k)(A.id))!=null&&re.loading?(f(),b("p",Xa,"Обновление...")):A.type==="stat_card"?(f(),b(Z,{key:2},[g("p",Za,D(i(C)(A)),1),g("p",el,D(i(v)(A)),1),i(E)(A)?(f(),b("p",tl,D(i(E)(A)),1)):K("",!0)],64)):A.type==="stat_list"?(f(),b(Z,{key:3},[i(O)(A).length?(f(),b("ul",rl,[(f(!0),b(Z,null,fe(i(O)(A),z=>(f(),b("li",{key:z.title+z.value},[g("span",null,D(z.title),1),g("strong",null,D(z.value),1)]))),128))])):(f(),b("p",nl,"Нет данных")),M[2]||(M[2]=g("p",{class:"sidebar-indicator-hint"},"Нажмите, чтобы открыть во вкладке",-1))],64)):A.type==="table"?(f(),b(Z,{key:4},[g("p",ol,"Строк: "+D(i(J)(A).length),1),M[3]||(M[3]=g("p",{class:"sidebar-indicator-hint"},"Нажмите, чтобы открыть во вкладке",-1))],64)):(f(),b("p",il,"Неподдерживаемый тип виджета")),(B=A.data.actions)!=null&&B.length||i(p)(A)?(f(),b("div",sl,[i(p)(A)?(f(),b("button",{key:0,class:"ghost",type:"button",onClick:q(z=>i(ie)(A.id),["stop"])},"Открыть вкладку",8,al)):K("",!0),(f(!0),b(Z,null,fe(A.data.actions||[],z=>(f(),b("button",{key:z.id,class:"ghost",type:"button",disabled:i(G)(A.id,z.id),onClick:q(he=>i(U)(A.id,z),["stop"])},D(z.title),9,ll))),128))])):K("",!0)],10,Wa)}),128))])):(f(),b("p",ul,"Для выбранной страницы индикаторы не настроены."))],2)]))}},dl=["draggable"],fl={class:"tree-node-row"},pl={class:"tree-text"},gl={class:"tree-meta"},ml={key:0,class:"tree-inline-actions"},vl={__name:"SidebarTreeSubgroupNode",props:{group:{type:Object,required:!0},subgroup:{type:Object,required:!0}},setup(n){const l=le(),{dragState:d,editMode:u,onSubgroupDragStart:a,clearDragState:p,onSubgroupDragOver:m,onSubgroupDrop:y,isSubgroupSelected:w,selectSubgroupNode:k,resolveSubgroupIcon:C,subgroupTotalItems:v,editSubgroup:E,addItem:O,removeSubgroup:J}=l;return(ie,G)=>(f(),b("li",{class:N(["tree-subgroup-item",{dragging:i(d).type==="subgroup"&&i(d).subgroupId===n.subgroup.id}]),draggable:i(u),onDragstart:G[4]||(G[4]=q(U=>i(a)(U,n.group.id,n.subgroup.id),["stop"])),onDragend:G[5]||(G[5]=q((...U)=>i(p)&&i(p)(...U),["stop"])),onDragover:G[6]||(G[6]=q(U=>i(m)(U,n.group.id,n.subgroup.id),["stop"])),onDrop:G[7]||(G[7]=q(U=>i(y)(U,n.group.id,n.subgroup.id),["stop"]))},[g("div",fl,[g("button",{class:N(["tree-node tree-subgroup",{active:i(w)(n.group.key,n.subgroup.id)}]),type:"button",onClick:G[0]||(G[0]=U=>i(k)(n.group.key,n.subgroup.id))},[(f(),F(be(i(C)(n.subgroup)),{class:"ui-icon tree-icon tree-sub-icon"})),g("span",pl,D(n.subgroup.title),1),g("span",gl,D(i(v)(n.subgroup)),1)],2),i(u)?(f(),b("div",ml,[P(i(Rn),{class:"ui-icon tree-grip"}),g("button",{class:"tree-mini-btn",type:"button",title:"Редактировать подгруппу",onClick:G[1]||(G[1]=q(U=>i(E)(n.group.id,n.subgroup.id),["stop"]))},[P(i(fr),{class:"ui-icon"})]),g("button",{class:"tree-mini-btn",type:"button",title:"Добавить элемент",onClick:G[2]||(G[2]=q(U=>i(O)(n.group.id,n.subgroup.id),["stop"]))},[P(i(pr),{class:"ui-icon"})]),g("button",{class:"tree-mini-btn danger",type:"button",title:"Удалить подгруппу",onClick:G[3]||(G[3]=q(U=>i(J)(n.group.id,n.subgroup.id),["stop"]))},[P(i(Bn),{class:"ui-icon"})])])):K("",!0)])],42,dl))}},bl=["draggable"],yl={class:"tree-node-row"},hl={class:"tree-text"},Il={class:"tree-meta"},wl={key:0,class:"tree-inline-actions"},Sl={class:"tree-subgroups"},_l={__name:"SidebarTreeGroupNode",props:{group:{type:Object,required:!0}},setup(n){const l=le(),{dragState:d,editMode:u,isDirectGroupNode:a,onGroupDragStart:p,clearDragState:m,onGroupDragOver:y,onGroupDrop:w,isGroupSelected:k,toggleGroupNode:C,isGroupExpanded:v,resolveGroupIcon:E,groupTotalItems:O,editGroup:J,addSubgroup:ie,removeGroup:G}=l;return(U,h)=>(f(),b("li",{class:N(["tree-group-item",{dragging:i(d).type==="group"&&i(d).groupId===n.group.id&&i(a)(n.group)}]),draggable:i(u)&&i(a)(n.group),onDragstart:h[4]||(h[4]=q(M=>i(p)(M,n.group),["stop"])),onDragend:h[5]||(h[5]=q((...M)=>i(m)&&i(m)(...M),["stop"])),onDragover:h[6]||(h[6]=q(M=>i(y)(M,n.group),["stop"])),onDrop:h[7]||(h[7]=q(M=>i(w)(M,n.group),["stop"]))},[g("div",yl,[g("button",{class:N(["tree-node tree-group",{active:i(k)(n.group.key)}]),type:"button",onClick:h[0]||(h[0]=M=>i(C)(n.group.key))},[g("span",{class:N(["tree-caret",{open:i(v)(n.group.key)}])},"▾",2),(f(),F(be(i(E)(n.group)),{class:"ui-icon tree-icon"})),g("span",hl,D(n.group.title),1),g("span",Il,D(i(O)(n.group)),1)],2),i(u)&&i(a)(n.group)?(f(),b("div",wl,[P(i(Rn),{class:"ui-icon tree-grip"}),g("button",{class:"tree-mini-btn",type:"button",title:"Редактировать группу",onClick:h[1]||(h[1]=q(M=>i(J)(n.group.id),["stop"]))},[P(i(fr),{class:"ui-icon"})]),g("button",{class:"tree-mini-btn",type:"button",title:"Добавить подгруппу",onClick:h[2]||(h[2]=q(M=>i(ie)(n.group.id),["stop"]))},[P(i(pr),{class:"ui-icon"})]),g("button",{class:"tree-mini-btn danger",type:"button",title:"Удалить группу",onClick:h[3]||(h[3]=q(M=>i(G)(n.group.id),["stop"]))},[P(i(Bn),{class:"ui-icon"})])])):K("",!0)]),Mi(g("ul",Sl,[(f(!0),b(Z,null,fe(n.group.subgroups,M=>(f(),F(vl,{key:M.id,group:n.group,subgroup:M},null,8,["group","subgroup"]))),128))],512),[[Oi,i(v)(n.group.key)]])],42,bl))}},kl={key:0,class:"sidebar-tree","aria-label":"Дерево сервисов"},$l={key:0,class:"tree-root"},Cl={key:1,class:"tree-empty"},Tl={__name:"SidebarTreePanel",setup(n){const l=le(),{treeGroups:d,filteredTreeGroups:u}=l;return(a,p)=>i(d).length?(f(),b("section",kl,[i(u).length?(f(),b("ul",$l,[(f(!0),b(Z,null,fe(i(u),m=>(f(),F(_l,{key:m.key,group:m},null,8,["group"]))),128))])):(f(),b("p",Cl,"По вашему запросу ничего не найдено."))])):K("",!0)}},El={__name:"DashboardSidebarView",setup(n){const l=le(),{isSidebarDetailed:d,isSidebarSectionsOnly:u}=l;return(a,p)=>(f(),b("aside",{class:N(["sidebar",{sections:i(u)}])},[p[0]||(p[0]=g("div",{id:"sidebar-particles",class:"sidebar-particles","aria-hidden":"true"},null,-1)),g("div",{class:N(["sidebar-content",{sections:i(u)}])},[P(Fa),i(d)?(f(),F(Tl,{key:0})):K("",!0),i(d)?(f(),F(cl,{key:1})):K("",!0)],2)],2))}},Ll=["src"],Pl={__name:"App",setup(n){const l=Ve(()=>He(()=>import("./LanHostModal-C5AJTrZc.js"),__vite__mapDeps([4,1,5,2]))),d=Ve(()=>He(()=>import("./IframeModal-DR4tYXRU.js"),__vite__mapDeps([6,5,1,2]))),u=Ve(()=>He(()=>import("./ItemEditorModal-C_ONZIS0.js"),__vite__mapDeps([7,1,5,2]))),a=Ve(()=>He(()=>import("./CommandPaletteModal-DhBEF8l-.js"),__vite__mapDeps([8,1,5,2]))),p=le(),{EMBLEM_SRC:m,closeCommandPalette:y,commandPaletteOpen:w,iframeModal:k,isSidebarSectionsOnly:C,isSidebarHidden:v,itemEditor:E,lanHostModal:O,toggleCommandPalette:J}=p,ie=H(!1);let G=0;function U(h){if((h.metaKey||h.ctrlKey)&&!h.altKey&&!h.shiftKey&&h.key.toLowerCase()==="k"){h.preventDefault(),J();return}h.key==="Escape"&&w.value&&(h.preventDefault(),y())}return At(()=>{G=globalThis.setTimeout(()=>{ie.value=!0},1e3),window.addEventListener("keydown",U)}),lt(()=>{G&&(globalThis.clearTimeout(G),G=0),window.removeEventListener("keydown",U)}),(h,M)=>(f(),b("div",{class:N(["shell",{"shell-motion-static":ie.value}])},[g("img",{class:"center-emblem",src:i(m),alt:"","aria-hidden":"true"},null,8,Ll),g("div",{class:N(["app-shell",{"sidebar-sections":i(C),"sidebar-hidden":i(v)}])},[i(v)?K("",!0):(f(),F(El,{key:0})),P(Ra)],2),i(O).open?(f(),F(i(l),{key:0})):K("",!0),i(k).open?(f(),F(i(d),{key:1})):K("",!0),i(E).open?(f(),F(i(u),{key:2})):K("",!0),i(w)?(f(),F(i(a),{key:3})):K("",!0)],2))}};function xl(){var u,a,p,m;if((a=(u=globalThis.matchMedia)==null?void 0:u.call(globalThis,"(prefers-reduced-motion: reduce)"))==null?void 0:a.matches)return"off";const l=Number(((p=globalThis.navigator)==null?void 0:p.hardwareConcurrency)||8),d=Number(((m=globalThis.navigator)==null?void 0:m.deviceMemory)||8);return l<=4||d<=4?"lite":"full"}function Al(n){const l=document.documentElement;l.dataset.fxMode=n,n==="off"?l.style.setProperty("--glow-enabled","0"):n==="lite"?l.style.setProperty("--glow-enabled","0.58"):l.style.setProperty("--glow-enabled","1")}function Dl(){var d;const n=(d=globalThis.matchMedia)==null?void 0:d.call(globalThis,"(prefers-reduced-motion: reduce)"),l=()=>Al(xl());l(),n!=null&&n.addEventListener?n.addEventListener("change",l):n!=null&&n.addListener&&n.addListener(l)}Dl();Gi(Pl).mount("#app");export{Sa as _,ve as a,le as u};
